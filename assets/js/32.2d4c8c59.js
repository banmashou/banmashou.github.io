(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{509:function(t,e,n){"use strict";n.r(e);var s=n(13),a=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h2",{attrs:{id:"按需引用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#按需引用"}},[t._v("#")]),t._v(" 按需引用")]),t._v(" "),e("p",[t._v("我们可以只打包使用的组件或api，需要使用到 "),e("a",{attrs:{href:"https://github.com/antfu/unplugin-auto-import",target:"_blank",rel:"noopener noreferrer"}},[t._v("unplugin-auto-import"),e("OutboundLink")],1),t._v("和 "),e("a",{attrs:{href:"https://github.com/antfu/unplugin-vue-components",target:"_blank",rel:"noopener noreferrer"}},[t._v("unplugin-vue-components"),e("OutboundLink")],1),t._v("插件。")]),t._v(" "),e("p",[t._v("下面是vite.config.ts配置文件中 plugins内容")]),t._v(" "),e("p",[t._v("实现了以下功能")]),t._v(" "),e("ul",[e("li",[t._v("element-plus的api与组件按需要加载")]),t._v(" "),e("li",[t._v("定义iconpark图标按需加载")]),t._v(" "),e("li",[t._v("composables目录文件按需加载")]),t._v(" "),e("li",[t._v("项目 src/components 目录组件按自动加载")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("import { Plugin } from 'vite'\nimport AutoImport from 'unplugin-auto-import/vite'\nimport Components from 'unplugin-vue-components/vite'\nimport { ElementPlusResolver, VueUseComponentsResolver } from 'unplugin-vue-components/resolvers'\n\nexport default function autoImport(plugins: Plugin[]) {\n  plugins.push(\n    AutoImport({\n      resolvers: [ElementPlusResolver()],\n      //定义element-plus api按需加载\n      imports: ['vue', 'vue-router'],\n      //composables目录文件按需加载\n      dirs: ['src/composables'],\n      dts: 'types/auto-imports.d.ts',\n    }),\n    Components({\n      resolvers: [\n        //element-plus组件按需导入\n        ElementPlusResolver(),\n        VueUseComponentsResolver(),\n        //针对iconpark图标按需导入\n        (componentName) => {\n          if (componentName.startsWith('Icon')) {\n            return { name: componentName.slice(4), from: '@icon-park/vue-next' }\n          }\n        },\n      ],\n      extensions: ['vue'],\n      dirs: ['src/components'],\n      //组件名称包含目录，防止同名组件冲突\n      directoryAsNamespace: true,\n      //指定类型声明文件，为true时在项目根目录创建\n      dts: 'types/components.d.ts',\n    }),\n  )\n}\n")])])]),e("p",[t._v("如果element-plus使用按需要加载，我们可以将css文件定义在vue模板index.html中")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('<link rel="stylesheet" href="//unpkg.com/element-plus/dist/index.css" />\n')])])]),e("h2",{attrs:{id:"可视化"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#可视化"}},[t._v("#")]),t._v(" 可视化")]),t._v(" "),e("p",[t._v("使用 "),e("a",{attrs:{href:"https://github.com/btd/rollup-plugin-visualizer",target:"_blank",rel:"noopener noreferrer"}},[t._v("rollup-plugin-visualizer"),e("OutboundLink")],1),t._v("可以对打包结果进行可视化的展示。")]),t._v(" "),e("h3",{attrs:{id:"安装配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#安装配置"}},[t._v("#")]),t._v(" 安装配置")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("yarn add --dev rollup-plugin-visualizer\n")])])]),e("p",[t._v("修改 "),e("code",[t._v("vite.config.ts")]),t._v(" 配置文件")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("import { visualizer } from 'rollup-plugin-visualizer';\n\n//...\nplugins: [\n  // other plugins\n  // ....\n  // \n  visualizer()\n],\n//...\n")])])]),e("h3",{attrs:{id:"使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[t._v("#")]),t._v(" 使用")]),t._v(" "),e("p",[t._v("下面执行编译命令")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("pnpm run build\n")])])]),e("p",[t._v("这时会在项目根目录生成 "),e("code",[t._v("stats.html")]),t._v(" 文件，使用浏览器打开这个文件即可查看到可视化的编译结果。")]),t._v(" "),e("h2",{attrs:{id:"分块打包"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#分块打包"}},[t._v("#")]),t._v(" 分块打包")]),t._v(" "),e("p",[t._v("使用分块打包可以将内容打包到不同的文件中，减少单个文件大小，提高加载速度。下面将node_modules的扩展单独进行打包。")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("export default defineConfig({\n  plugins: [vue()],\n  build: {\n    rollupOptions: {\n    \temptyOutDir: true,\n      output: {\n        manualChunks(id) {\n          if (id.includes('node_modules')) {\n            return id.toString().split('node_modules/')[1].split('/')[0].toString()\n          }\n        },\n      },\n    },\n  },\n})\n")])])]),e("h2",{attrs:{id:"cdn加载"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#cdn加载"}},[t._v("#")]),t._v(" CDN加载")]),t._v(" "),e("p",[t._v("可以使用cdn加载的包，建议使用cdn完成，这样会减少打包后的文件大小。")]),t._v(" "),e("p",[t._v("下面是使用cdn加载 echarts、font-awesome、animate.css包。")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('<script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.2.2/echarts.min.js"><\/script>\n<link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet" />\n<link href="https://cdn.bootcdn.net/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet" />\n')])])]),e("p",[t._v("如果使用ts编译代码，不要忘记安装 echarts的类型支持")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("yarn add @types/echarts\n")])])])])}),[],!1,null,null,null);e.default=a.exports}}]);